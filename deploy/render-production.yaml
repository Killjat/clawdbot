services:
  - type: web
    name: moltbot-production
    runtime: docker
    plan: starter
    region: singapore  # 选择离亚洲近的区域
    
    # 健康检查
    healthCheckPath: /health
    
    # 环境变量
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: "8080"
      - key: CLAWDBOT_STATE_DIR
        value: /data/.clawdbot
      - key: CLAWDBOT_WORKSPACE_DIR
        value: /data/workspace
      - key: CLAWDBOT_PREFER_PNPM
        value: "1"
      - key: NODE_OPTIONS
        value: "--max-old-space-size=1536"
      
      # 密钥 (需要在 Render 控制台设置)
      - key: CLAWDBOT_GATEWAY_TOKEN
        sync: false
      - key: DEEPSEEK_API_KEY
        sync: false
      - key: SETUP_PASSWORD
        generateValue: true
    
    # 持久化存储
    disk:
      name: moltbot-data
      mountPath: /data
      sizeGB: 1
    
    # 自动部署设置
    autoDeploy: true
    
    # 构建设置
    buildCommand: "echo 'Using pre-built Docker image'"
    startCommand: "node dist/index.js gateway --allow-unconfigured --port 8080 --bind lan"