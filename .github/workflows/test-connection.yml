name: Test Server Connection

on:
  workflow_dispatch:

jobs:
  test-connection:
    runs-on: ubuntu-latest
    steps:
      - name: Test server connection
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          password: ${{ secrets.SERVER_PASSWORD }}
          port: ${{ secrets.SERVER_PORT || 22 }}
          script: |
            echo "ğŸ‰ SSH è¿æ¥æˆåŠŸï¼"
            echo "æœåŠ¡å™¨ä¿¡æ¯ï¼š"
            uname -a
            echo ""
            echo "å½“å‰ç”¨æˆ·ï¼š"
            whoami
            echo ""
            echo "å½“å‰ç›®å½•ï¼š"
            pwd
            echo ""
            echo "Docker çŠ¶æ€ï¼š"
            if command -v docker &> /dev/null; then
              docker --version
              docker ps | head -5
            else
              echo "Docker æœªå®‰è£…"
            fi
            echo ""
            echo "ç£ç›˜ç©ºé—´ï¼š"
            df -h | head -5
            echo ""
            echo "å†…å­˜ä½¿ç”¨ï¼š"
            free -h